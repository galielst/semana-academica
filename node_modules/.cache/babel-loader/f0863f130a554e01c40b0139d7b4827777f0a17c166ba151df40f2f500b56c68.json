{"ast":null,"code":"import{useState,useEffect}from\"react\";import{supabase}from\"../../supabaseClient\";import Button from\"../ui/Button\";import Input from\"../ui/Input\";import Label from\"../ui/Label\";import Select from\"../ui/Select\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ProfileForm(_ref){let{profile,onSaved}=_ref;const[showMessage,setShowMessage]=useState(false);const[errorMessage,setErrorMessage]=useState(\"\");// Estados para inputs\nconst[fullName,setFullName]=useState(\"\");const[phone,setPhone]=useState(\"\");const[tipoPrograma,setTipoPrograma]=useState(\"\");// TSU o Licenciatura\nconst[cuatrimestre,setCuatrimestre]=useState(\"\");// 1,4,7,10\nconst[programa,setPrograma]=useState(\"\");// Administración o Contaduría\n// Inicializa los estados cuando profile llegue\nuseEffect(()=>{if(profile&&!fullName){var _profile$cuatrimestre;// solo inicializa si fullName aún está vacío\nsetFullName(profile.full_name||\"\");setPhone(profile.phone||\"\");setTipoPrograma(profile.tipo_programa||\"\");setCuatrimestre(((_profile$cuatrimestre=profile.cuatrimestre)===null||_profile$cuatrimestre===void 0?void 0:_profile$cuatrimestre.toString())||\"\");setPrograma(profile.programa_educativo||\"\");}},[profile]);// Validaciones simples antes de enviar\nconst validateForm=()=>{if(!fullName.trim())return\"El nombre completo es obligatorio.\";if(!tipoPrograma)return\"Selecciona el tipo de programa.\";if(!cuatrimestre)return\"Selecciona el cuatrimestre.\";if(!programa)return\"Selecciona el programa educativo.\";return null;};const onSubmit=async e=>{e.preventDefault();if(!profile)return;// Evita errores si profile es null\nconst validationError=validateForm();if(validationError){setErrorMessage(validationError);return;}const{data,error}=await supabase.from(\"profiles\").update({full_name:fullName,phone,tipo_programa:tipoPrograma,cuatrimestre:Number(cuatrimestre),// convertir a número\nprograma_educativo:programa}).eq(\"id\",profile.id).select().single();if(error){console.error(\"Error actualizando perfil:\",error.message);setErrorMessage(\"Error al guardar el perfil. Revisa los datos.\");return;}onSaved(data);setShowMessage(true);setErrorMessage(\"\");setTimeout(()=>setShowMessage(false),2000);};if(!profile)return/*#__PURE__*/_jsx(\"p\",{children:\"Cargando perfil...\"});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"profile-title\",children:\"Mi Perfil\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,className:\"profile-form\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{children:\"Nombre completo\"}),/*#__PURE__*/_jsx(Input,{name:\"full_name\",value:fullName,onChange:e=>setFullName(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{children:\"Tel\\xE9fono\"}),/*#__PURE__*/_jsx(Input,{name:\"phone\",value:phone,onChange:e=>setPhone(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{children:\"Nivel Educativo\"}),/*#__PURE__*/_jsxs(Select,{name:\"tipo_programa\",value:tipoPrograma,onChange:e=>setTipoPrograma(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Selecciona tipo\\u2026\"}),/*#__PURE__*/_jsx(\"option\",{value:\"TSU\",children:\"TSU\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Licenciatura\",children:\"Licenciatura\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{children:\"Cuatrimestre\"}),/*#__PURE__*/_jsxs(Select,{name:\"cuatrimestre\",value:cuatrimestre,onChange:e=>setCuatrimestre(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Selecciona cuatrimestre\\u2026\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"1\\xB0\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4\",children:\"4\\xB0\"}),/*#__PURE__*/_jsx(\"option\",{value:\"7\",children:\"7\\xB0\"}),/*#__PURE__*/_jsx(\"option\",{value:\"10\",children:\"10\\xB0\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{children:\"Programa educativo\"}),/*#__PURE__*/_jsxs(Select,{name:\"programa\",value:programa,onChange:e=>setPrograma(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Selecciona programa\\u2026\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Administracion\",children:\"Administraci\\xF3n\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Contaduria\",children:\"Contadur\\xEDa\"})]})]}),errorMessage&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:errorMessage}),/*#__PURE__*/_jsx(Button,{children:\"Guardar\"})]}),showMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-content\",children:\"Guardado con \\xE9xito\"})})]});}","map":{"version":3,"names":["useState","useEffect","supabase","Button","Input","Label","Select","jsx","_jsx","jsxs","_jsxs","ProfileForm","_ref","profile","onSaved","showMessage","setShowMessage","errorMessage","setErrorMessage","fullName","setFullName","phone","setPhone","tipoPrograma","setTipoPrograma","cuatrimestre","setCuatrimestre","programa","setPrograma","_profile$cuatrimestre","full_name","tipo_programa","toString","programa_educativo","validateForm","trim","onSubmit","e","preventDefault","validationError","data","error","from","update","Number","eq","id","select","single","console","message","setTimeout","children","className","name","value","onChange","target"],"sources":["C:/Users/Home/Documents/registro-de-eventos/src/components/Profile/ProfileForm.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { supabase } from \"../../supabaseClient\";\r\nimport Button from \"../ui/Button\";\r\nimport Input from \"../ui/Input\";\r\nimport Label from \"../ui/Label\";\r\nimport Select from \"../ui/Select\";\r\n\r\nexport default function ProfileForm({ profile, onSaved }) {\r\n  const [showMessage, setShowMessage] = useState(false);\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n\r\n  // Estados para inputs\r\n  const [fullName, setFullName] = useState(\"\");\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [tipoPrograma, setTipoPrograma] = useState(\"\"); // TSU o Licenciatura\r\n  const [cuatrimestre, setCuatrimestre] = useState(\"\"); // 1,4,7,10\r\n  const [programa, setPrograma] = useState(\"\"); // Administración o Contaduría\r\n\r\n  // Inicializa los estados cuando profile llegue\r\n useEffect(() => {\r\n  if (profile && !fullName) {  // solo inicializa si fullName aún está vacío\r\n    setFullName(profile.full_name || \"\");\r\n    setPhone(profile.phone || \"\");\r\n    setTipoPrograma(profile.tipo_programa || \"\");\r\n    setCuatrimestre(profile.cuatrimestre?.toString() || \"\");\r\n    setPrograma(profile.programa_educativo || \"\");\r\n  }\r\n}, [profile]);\r\n\r\n  // Validaciones simples antes de enviar\r\n  const validateForm = () => {\r\n    if (!fullName.trim()) return \"El nombre completo es obligatorio.\";\r\n    if (!tipoPrograma) return \"Selecciona el tipo de programa.\";\r\n    if (!cuatrimestre) return \"Selecciona el cuatrimestre.\";\r\n    if (!programa) return \"Selecciona el programa educativo.\";\r\n    return null;\r\n  };\r\n\r\n  const onSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    if (!profile) return; // Evita errores si profile es null\r\n\r\n    const validationError = validateForm();\r\n    if (validationError) {\r\n      setErrorMessage(validationError);\r\n      return;\r\n    }\r\n\r\n    const { data, error } = await supabase\r\n      .from(\"profiles\")\r\n      .update({\r\n        full_name: fullName,\r\n        phone,\r\n        tipo_programa: tipoPrograma,\r\n        cuatrimestre: Number(cuatrimestre), // convertir a número\r\n        programa_educativo: programa,\r\n      })\r\n      .eq(\"id\", profile.id)\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error(\"Error actualizando perfil:\", error.message);\r\n      setErrorMessage(\"Error al guardar el perfil. Revisa los datos.\");\r\n      return;\r\n    }\r\n\r\n    onSaved(data);\r\n    setShowMessage(true);\r\n    setErrorMessage(\"\");\r\n    setTimeout(() => setShowMessage(false), 2000);\r\n  };\r\n\r\n  if (!profile) return <p>Cargando perfil...</p>;\r\n\r\n  return (\r\n    <div>\r\n      <h3 className=\"profile-title\">Mi Perfil</h3>\r\n      <form onSubmit={onSubmit} className=\"profile-form\">\r\n        <div>\r\n          <Label>Nombre completo</Label>\r\n          <Input\r\n            name=\"full_name\"\r\n            value={fullName}\r\n            onChange={(e) => setFullName(e.target.value)}\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <Label>Teléfono</Label>\r\n          <Input\r\n            name=\"phone\"\r\n            value={phone}\r\n            onChange={(e) => setPhone(e.target.value)}\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <Label>Nivel Educativo</Label>\r\n          <Select\r\n            name=\"tipo_programa\"\r\n            value={tipoPrograma}\r\n            onChange={(e) => setTipoPrograma(e.target.value)}\r\n          >\r\n            <option value=\"\">Selecciona tipo…</option>\r\n            <option value=\"TSU\">TSU</option>\r\n            <option value=\"Licenciatura\">Licenciatura</option>\r\n          </Select>\r\n        </div>\r\n\r\n        <div>\r\n          <Label>Cuatrimestre</Label>\r\n          <Select\r\n            name=\"cuatrimestre\"\r\n            value={cuatrimestre}\r\n            onChange={(e) => setCuatrimestre(e.target.value)}\r\n          >\r\n            <option value=\"\">Selecciona cuatrimestre…</option>\r\n            <option value=\"1\">1°</option>\r\n            <option value=\"4\">4°</option>\r\n            <option value=\"7\">7°</option>\r\n            <option value=\"10\">10°</option>\r\n          </Select>\r\n        </div>\r\n\r\n        <div>\r\n          <Label>Programa educativo</Label>\r\n          <Select\r\n            name=\"programa\"\r\n            value={programa}\r\n            onChange={(e) => setPrograma(e.target.value)}\r\n          >\r\n            <option value=\"\">Selecciona programa…</option>\r\n            <option value=\"Administracion\">Administración</option>\r\n            <option value=\"Contaduria\">Contaduría</option>\r\n          </Select>\r\n        </div>\r\n\r\n        {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\r\n\r\n        <Button>Guardar</Button>\r\n      </form>\r\n\r\n      {showMessage && (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"modal-content\">Guardado con éxito</div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}