{"ast":null,"code":"import{useState}from\"react\";import{useNavigate}from\"react-router-dom\";import{supabase}from\"../../supabaseClient\";import Button from\"../ui/Button\";import Input from\"../ui/Input\";import Label from\"../ui/Label\";import Select from\"../ui/Select\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function AuthForm(){const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const[mode,setMode]=useState(\"login\");const[role,setRole]=useState(\"alumno\");const[loading,setLoading]=useState(false);const[error,setError]=useState(\"\");const[message,setMessage]=useState(\"\");const navigate=useNavigate();const onSubmit=async e=>{e.preventDefault();setLoading(true);setError(\"\");setMessage(\"\");try{if(mode===\"signup\"){const{data:existingUser}=await supabase.from(\"profiles\").select(\"id\").eq(\"email\",email).single();if(existingUser){setError(\"❌ Este correo ya está registrado. Intenta iniciar sesión.\");return;}const{data,error}=await supabase.auth.signUp({email,password});if(error)throw error;const user=data.user;if(!user){setError(\"❌ No se pudo crear el usuario. Intenta de nuevo.\");return;}await supabase.from(\"profiles\").insert({id:user.id,email,role,full_name:\"\",phone:\"\"});setMessage(\"✅ Registro exitoso. Ingresa a tu correo y valida tu cuenta para poder ingresar.\");setEmail(\"\");setPassword(\"\");setRole(\"alumno\");}else{const{error}=await supabase.auth.signInWithPassword({email,password});if(error)setError(\"❌ Credenciales incorrectas. Intenta de nuevo.\");}}catch(err){setError(err.message||\"Ocurrió un error inesperado.\");}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{style:{maxWidth:360,margin:\"40px auto\",padding:20,border:\"1px solid #e5e7eb\",borderRadius:12,background:\"#fff\",boxShadow:\"0 2px 6px rgba(0,0,0,0.05)\"},children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,style:{display:\"grid\",gap:14},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:8,fontSize:14},children:[/*#__PURE__*/_jsx(Button,{type:\"button\",onClick:()=>setMode(\"login\"),variant:mode===\"login\"?\"primary\":\"secondary\",children:\"Iniciar sesi\\xF3n\"}),/*#__PURE__*/_jsx(Button,{type:\"button\",onClick:()=>setMode(\"signup\"),variant:mode===\"signup\"?\"primary\":\"secondary\",children:\"Crear cuenta\"})]}),mode===\"signup\"&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{children:\"Rol\"}),/*#__PURE__*/_jsx(Select,{value:role,onChange:e=>setRole(e.target.value),style:{width:\"100%\"},children:/*#__PURE__*/_jsx(\"option\",{value:\"alumno\",children:\"Alumno\"})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{children:\"Correo\"}),/*#__PURE__*/_jsx(Input,{type:\"email\",value:email,onChange:e=>setEmail(e.target.value),required:true,style:{width:\"80%\"}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{children:\"Contrase\\xF1a\"}),/*#__PURE__*/_jsx(Input,{type:\"password\",value:password,onChange:e=>setPassword(e.target.value),required:true,style:{width:\"80%\"}})]}),error&&/*#__PURE__*/_jsx(\"p\",{style:{color:\"#dc2626\",fontSize:13},children:error}),message&&/*#__PURE__*/_jsx(\"p\",{style:{color:\"#16a34a\",fontSize:13},children:message}),/*#__PURE__*/_jsx(Button,{disabled:loading,style:{width:\"85%\"},children:loading?\"Procesando...\":mode===\"signup\"?\"Registrarme\":\"Entrar\"}),mode===\"login\"&&/*#__PURE__*/_jsx(\"p\",{style:{fontSize:14,textAlign:\"center\",marginTop:8},children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>navigate(\"/forgot-password\"),style:{background:\"none\",border:\"none\",color:\"#2563eb\",cursor:\"pointer\",textDecoration:\"underline\"},children:\"\\xBFOlvidaste tu contrase\\xF1a?\"})}),mode===\"signup\"&&/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:13,color:\"#4b5563\"},children:[\"Una vez dando clic en \",/*#__PURE__*/_jsx(\"b\",{children:\"Registrarme\"}),\", revisa tu bandeja de correo para validar tu cuenta.\"]})]})});}","map":{"version":3,"names":["useState","useNavigate","supabase","Button","Input","Label","Select","jsx","_jsx","jsxs","_jsxs","AuthForm","email","setEmail","password","setPassword","mode","setMode","role","setRole","loading","setLoading","error","setError","message","setMessage","navigate","onSubmit","e","preventDefault","data","existingUser","from","select","eq","single","auth","signUp","user","insert","id","full_name","phone","signInWithPassword","err","style","maxWidth","margin","padding","border","borderRadius","background","boxShadow","children","display","gap","fontSize","type","onClick","variant","value","onChange","target","width","required","color","disabled","textAlign","marginTop","cursor","textDecoration"],"sources":["C:/Users/Home/Documents/registro-de-eventos/src/components/Auth/AuthForm.jsx"],"sourcesContent":["import { useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { supabase } from \"../../supabaseClient\";\r\nimport Button from \"../ui/Button\";\r\nimport Input from \"../ui/Input\";\r\nimport Label from \"../ui/Label\";\r\nimport Select from \"../ui/Select\";\r\n\r\nexport default function AuthForm() {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [mode, setMode] = useState(\"login\");\r\n  const [role, setRole] = useState(\"alumno\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n  const [message, setMessage] = useState(\"\");\r\n  const navigate = useNavigate();\r\n\r\n  const onSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setError(\"\");\r\n    setMessage(\"\");\r\n\r\n    try {\r\n      if (mode === \"signup\") {\r\n        const { data: existingUser } = await supabase\r\n          .from(\"profiles\")\r\n          .select(\"id\")\r\n          .eq(\"email\", email)\r\n          .single();\r\n\r\n        if (existingUser) {\r\n          setError(\"❌ Este correo ya está registrado. Intenta iniciar sesión.\");\r\n          return;\r\n        }\r\n\r\n        const { data, error } = await supabase.auth.signUp({ email, password });\r\n        if (error) throw error;\r\n\r\n        const user = data.user;\r\n        if (!user) {\r\n          setError(\"❌ No se pudo crear el usuario. Intenta de nuevo.\");\r\n          return;\r\n        }\r\n\r\n        await supabase.from(\"profiles\").insert({\r\n          id: user.id,\r\n          email,\r\n          role,\r\n          full_name: \"\",\r\n          phone: \"\"\r\n        });\r\n\r\n        setMessage(\r\n          \"✅ Registro exitoso. Ingresa a tu correo y valida tu cuenta para poder ingresar.\"\r\n        );\r\n        setEmail(\"\");\r\n        setPassword(\"\");\r\n        setRole(\"alumno\");\r\n      } else {\r\n        const { error } = await supabase.auth.signInWithPassword({\r\n          email,\r\n          password\r\n        });\r\n        if (error) setError(\"❌ Credenciales incorrectas. Intenta de nuevo.\");\r\n      }\r\n    } catch (err) {\r\n      setError(err.message || \"Ocurrió un error inesperado.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        maxWidth: 360,\r\n        margin: \"40px auto\",\r\n        padding: 20,\r\n        border: \"1px solid #e5e7eb\",\r\n        borderRadius: 12,\r\n        background: \"#fff\",\r\n        boxShadow: \"0 2px 6px rgba(0,0,0,0.05)\"\r\n      }}\r\n    >\r\n      <form onSubmit={onSubmit} style={{ display: \"grid\", gap: 14 }}>\r\n        {/* Botones modo */}\r\n        <div style={{ display: \"flex\", gap: 8, fontSize: 14 }}>\r\n          <Button\r\n            type=\"button\"\r\n            onClick={() => setMode(\"login\")}\r\n            variant={mode === \"login\" ? \"primary\" : \"secondary\"}\r\n          >\r\n            Iniciar sesión\r\n          </Button>\r\n          <Button\r\n            type=\"button\"\r\n            onClick={() => setMode(\"signup\")}\r\n            variant={mode === \"signup\" ? \"primary\" : \"secondary\"}\r\n          >\r\n            Crear cuenta\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Selección de rol en signup */}\r\n        {mode === \"signup\" && (\r\n          <div>\r\n            <Label>Rol</Label>\r\n            <Select\r\n              value={role}\r\n              onChange={(e) => setRole(e.target.value)}\r\n              style={{ width: \"100%\" }}\r\n            >\r\n              <option value=\"alumno\">Alumno</option>\r\n            </Select>\r\n          </div>\r\n        )}\r\n\r\n        {/* Campos */}\r\n        <div>\r\n          <Label>Correo</Label>\r\n          <Input\r\n            type=\"email\"\r\n            value={email}\r\n            onChange={(e) => setEmail(e.target.value)}\r\n            required\r\n            style={{ width: \"80%\" }}\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <Label>Contraseña</Label>\r\n          <Input\r\n            type=\"password\"\r\n            value={password}\r\n            onChange={(e) => setPassword(e.target.value)}\r\n            required\r\n            style={{ width: \"80%\" }}\r\n          />\r\n        </div>\r\n\r\n        {/* Mensajes */}\r\n        {error && <p style={{ color: \"#dc2626\", fontSize: 13 }}>{error}</p>}\r\n        {message && <p style={{ color: \"#16a34a\", fontSize: 13 }}>{message}</p>}\r\n\r\n        {/* Botón submit */}\r\n        <Button disabled={loading}  style={{ width: \"85%\" }}>\r\n          {loading ? \"Procesando...\" : mode === \"signup\" ? \"Registrarme\" : \"Entrar\"}\r\n        </Button>\r\n\r\n        {/* Enlace a recuperar contraseña */}\r\n        {mode === \"login\" && (\r\n          <p style={{ fontSize: 14, textAlign: \"center\", marginTop: 8 }}>\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => navigate(\"/forgot-password\")}\r\n              style={{\r\n                background: \"none\",\r\n                border: \"none\",\r\n                color: \"#2563eb\",\r\n                cursor: \"pointer\",\r\n                textDecoration: \"underline\"\r\n              }}\r\n            >\r\n              ¿Olvidaste tu contraseña?\r\n            </button>\r\n          </p>\r\n        )}\r\n\r\n        {mode === \"signup\" && (\r\n          <p style={{ fontSize: 13, color: \"#4b5563\" }}>\r\n            Una vez dando clic en <b>Registrarme</b>, revisa tu bandeja de correo para validar tu cuenta.\r\n          </p>\r\n        )}\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}